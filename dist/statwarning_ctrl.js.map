{"version":3,"sources":["../src/statwarning_ctrl.js"],"names":["moment","$","_","kbn","config","TimeSeries","MetricsPanelCtrl","StatWarningCtrl","$scope","$injector","panelDefaults","legend","show","values","threshold","warningAbove","value","set","criticalAbove","warningBelow","criticalBelow","showValue","width","height","fontSize","fontWeight","font","family","statData","message","image","text","title","name","subText","defaults","panel","events","on","onInitEditMode","bind","onDataReceived","render","metrics","addEditorTab","dataList","series","map","seriesHandler","setValues","checkThresholds","seriesData","datapoints","alias","target","flotpairs","getFlotPairs","nullPointMode","valueFormated","stat","length","data","error","JSON","stringify","lastPoint","last","lastValue","isArray","valueName","valueRounded","parseFloat","isString","escape","stats","decimalInfo","getDecimalsForValue","formatFunc","valueFormats","format","parseInt","roundValue","decimals","isNumber","scaledDecimals","delta","dec","Math","floor","log","LN10","magn","pow","norm","size","result","max","scope","elem","$panelContainer","find","bgColor","css","templateUrl"],"mappings":"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","file":"statwarning_ctrl.js","sourcesContent":["\nimport moment from 'moment';\n\n\nimport $ from 'jquery';\nimport _ from 'lodash';\nimport 'jquery.flot';\nimport 'jquery.flot.gauge';\nimport 'jquery.flot.pie';\n\nimport kbn from 'app/core/utils/kbn';\nimport config from 'app/core/config';\nimport TimeSeries from 'app/core/time_series2';\nimport {MetricsPanelCtrl} from 'app/plugins/sdk';\n\nexport class StatWarningCtrl extends MetricsPanelCtrl {\n  constructor($scope,$injector){\n    super($scope,$injector);\n    const panelDefaults = {\n      legend: {\n        show: true, // disable/enable legend\n        values: true\n      },\n      threshold:{\n        warningAbove:{\n          value:0,\n          set:false\n        },\n        criticalAbove:{\n          value:0,\n          set:false\n        },\n        warningBelow:{\n          value:0,\n          set:false\n        },\n        criticalBelow:{\n          value:0,\n          set:false\n        }\n      },\n      values:{\n        showValue:true\n      },\n      width:100,\n      height:100,\n      fontSize: '25px',\n      fontWeight: '10px',\n      font: { family: 'Myriad Set Pro, Helvetica Neue, Helvetica, Arial, sans-serif' },\n      statData:{},\n      message:\"\",\n      image:\"default.png\",\n      text:{\n        title:'',\n        name:'',\n        subText:''\n      }\n    }\n    _.defaults(this.panel, panelDefaults);\n    _.defaults(this.panel.legend, panelDefaults.legend);\n    this.events.on('init-edit-mode',this.onInitEditMode.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-snapshot-load', this.onDataReceived.bind(this));\n    this.events.on('panel-initialized', this.render.bind(this));\n    //this.events.on('panel-teardown', this.onPanelTeardown.bind(this));\n    this.metrics = {};\n  }\n  onInitEditMode() {\n    this.addEditorTab('Options','public/plugins/grafana-statwarning-panel/editor.html',2);\n  }\n\n\n  onDataReceived(dataList) {\n\n    this.series = dataList.map(this.seriesHandler.bind(this));\n\n    this.setValues(this.metrics);\n\n    this.checkThresholds();\n    this.render();\n  }\n\n  seriesHandler(seriesData) {\n    var series = new TimeSeries({\n      datapoints: seriesData.datapoints,\n      alias: seriesData.target,\n    });\n    series.flotpairs = series.getFlotPairs(this.panel.nullPointMode);\n\n    return series;\n  }\n\n  increaseSize(){\n    this.panel.width += 10;\n    this.panel.height += 10;\n  }\n\n\n  decreaseSize(){\n    this.panel.width -= 10;\n    this.panel.height -= 10;\n  }\n\n  checkThresholds(){\n\n    if(!this.metrics.valueFormated){\n      this.panel.image = \"default.png\";\n      this.panel.message = \"\";\n      return;\n    }\n\n    if(this.panel.threshold.criticalAbove.set){\n      if(this.metrics.valueFormated >= this.panel.threshold.criticalAbove.value){\n        this.panel.image = \"status_criticalmax.png\";\n        this.panel.message = \"CRITICAL\";\n        return;\n      }\n    }\n\n    if(this.panel.threshold.warningAbove.set){\n      if(!this.panel.threshold.criticalAbove.set || (this.panel.threshold.criticalAbove.set && this.metrics.valueFormated <= this.panel.threshold.criticalAbove.value)){\n        if(this.metrics.valueFormated >= this.panel.threshold.warningAbove.value){\n          this.panel.image = \"status_warningmax.png\";\n          this.panel.message = \"WARNING\";\n          return;\n        }\n      }\n    }\n\n    if(this.panel.threshold.criticalBelow.set){\n      if(this.metrics.valueFormated <= this.panel.threshold.criticalBelow.value){\n        this.panel.image = \"status_criticalmin.png\";\n        this.panel.message = \"CRITICAL\";\n        return;\n      }\n    }\n\n    if(this.panel.threshold.warningBelow.set){\n      if(!this.panel.threshold.criticalBelow.set || (this.panel.threshold.criticalBelow.set && this.metrics.valueFormated >= this.panel.threshold.criticalBelow.value)){\n        if(this.metrics.valueFormated <= this.panel.threshold.warningBelow.value){\n          this.panel.image = \"status_warningmin.png\";\n          this.panel.message = \"WARNING\";\n          return;\n        }\n      }\n    }\n\n    this.panel.image = \"status_ok.png\";\n    this.panel.message = \"OK\";\n\n  }\n\n  setThresholds(stat){\n    stat.set = true;\n    this.render();\n  }\n\n  statName(){\n\n    if(this.panel.text.name.length === 0 && this.metrics.name){\n      return this.metrics.name;\n    } else if(this.panel.text.name.length !== 0){\n      return this.panel.text.name;\n    } else {\n      return \"N/A\"\n    }\n  }\n\n  setMessage(){\n    if(this.panel.message.length !== 0){\n      return this.panel.message + \" - \";\n    } else {\n      return \"\";\n    }\n  }\n\n  setValues(data) {\n\n\n\n    if(this.series.length === 0){\n      this.metrics = {};\n      return;\n    }\n\n    data.flotpairs = [];\n\n    if (this.series.length > 1) {\n      var error = {}\n      error.message = 'Multiple Series Error';\n      error.data = 'Metric query returns ' + this.series.length +\n        ' series. Single Stat Panel expects a single series.\\n\\nResponse:\\n'+JSON.stringify(this.series);\n      throw error;\n    }\n\n    if (this.series && this.series.length > 0) {\n      var lastPoint = _.last(this.series[0].datapoints);\n      var lastValue = _.isArray(lastPoint) ? lastPoint[0] : null;\n\n      if (this.panel.valueName === 'name') {\n        data.value = 0;\n        data.valueRounded = 0;\n        data.valueFormated = parseFloat(this.series[0].alias);\n        data.name = this.series[0].alias;\n      } else if (_.isString(lastValue)) {\n        data.value = 0;\n        data.valueFormated = parseFloat(_.escape(lastValue));\n        data.valueRounded = 0;\n        data.name = this.series[0].alias;\n      } else {\n        data.value = this.series[0].stats[this.panel.valueName];\n        data.flotpairs = this.series[0].flotpairs;\n\n        var decimalInfo = this.getDecimalsForValue(data.value);\n        var formatFunc = kbn.valueFormats[this.panel.format];\n        data.valueFormated = parseInt(_.escape(lastValue));\n        data.valueRounded = kbn.roundValue(data.value, decimalInfo.decimals);\n        data.name = this.series[0].alias;\n      }\n    }\n  }\n\n\n  getDecimalsForValue(value) {\n    if (_.isNumber(this.panel.decimals)) {\n      return {decimals: this.panel.decimals, scaledDecimals: null};\n    }\n\n    var delta = value / 2;\n    var dec = -Math.floor(Math.log(delta) / Math.LN10);\n\n    var magn = Math.pow(10, -dec),\n      norm = delta / magn, // norm is between 1.0 and 10.0\n      size;\n\n    if (norm < 1.5) {\n      size = 1;\n    } else if (norm < 3) {\n      size = 2;\n      // special case for 2.5, requires an extra decimal\n      if (norm > 2.25) {\n        size = 2.5;\n        ++dec;\n      }\n    } else if (norm < 7.5) {\n      size = 5;\n    } else {\n      size = 10;\n    }\n\n    size *= magn;\n\n    // reduce starting decimals if not needed\n    if (Math.floor(value) === value) { dec = 0; }\n\n    var result = {};\n    result.decimals = Math.max(0, dec);\n    result.scaledDecimals = result.decimals - Math.floor(Math.log(size) / Math.LN10) + 2;\n\n    return result;\n  }\n\n  link(scope, elem) {\n    this.events.on('render', () => {\n      const $panelContainer = elem.find('.panel-container');\n      if (this.panel.bgColor) {\n        $panelContainer.css('background-color', this.panel.bgColor);\n      } else {\n        $panelContainer.css('background-color', '');\n      }\n\n    });\n  }\n}\n\nStatWarningCtrl.templateUrl = 'module.html';\n"]}